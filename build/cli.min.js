/**
 * cli-panel - Command line interface for angular sites
 * @version v0.1.3
 * @link http://liksu.github.io/cli-panel/
 * @license MIT
 */
"use strict";function _typeof(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}window.cli=new function(){this.cache={commandInput:null,buffer:null,panel:null,show:!1},this.history=[],this.settings={prompt:"> "},this.workers={pre:[],commands:{},post:[],keys:{}},this.templates={},this.addHtml=function(e,t,n){this.templates[e]={html:t,selector:n||"body"}}.bind(this),document.addEventListener("DOMContentLoaded",function(){var e=this.templates,t={};Object.keys(e).forEach(function(n){var i=e[n].selector;t[i]||(t[i]=document.createElement("div"),t[i].innerHTML=""),t[i].innerHTML+=e[n].html}),Object.keys(t).forEach(function(e){document.querySelector(e).appendChild(t[e])}),this.cache.panel=document.querySelector(".cli .cli-panel"),this.cache.commandInput=this.cache.panel.querySelector(".cli .cli-line .cli-command"),this.cache.buffer=this.cache.panel.querySelector(".cli-buffer"),this.cache.prompt=this.cache.panel.querySelector(".cli-prompt"),this.cache.prompt.innerHTML=this.settings.prompt,this.toggle(this.cache.show)}.bind(this)),document.addEventListener("keydown",function(e){var t=e.target===this.cache.commandInput;if(192===e.keyCode){if(!t)return;e.preventDefault(),this.toggle()}else 13===e.keyCode&&t&&(cli.print(cli.cache.prompt.outerHTML+this.cache.commandInput.value),cli.run(this.cache.commandInput.value),this.cache.buffer.scrollTop=this.cache.buffer.scrollHeight,this.cache.commandInput.value="");this.workers.keys[e.keyCode]&&this.workers.keys[e.keyCode].forEach(function(n){return n.worker(e,t)}),this.workers.keys[0]&&this.workers.keys[0].forEach(function(n){return n.worker(e,t)})}.bind(this)),this.show=function(){this.cache.panel.className+=" show",this.cache.show=!0,this.focus()}.bind(this),this.hide=function(){this.cache.panel.className=this.cache.panel.className.replace(/\s*show/g,""),this.cache.show=!1}.bind(this),this.toggle=function(e){void 0===e&&(e=!this.cache.show),e?this.show():this.hide()}.bind(this),this.mouseUp=function(){var e="";window.getSelection?e=window.getSelection().toString():document.selection&&"Control"!=document.selection.type&&(e=document.selection.createRange().text),e||this.focus()}.bind(this),this.focus=function(){var e=this.cache.commandInput;setTimeout(function(){var t=e.value.length;if(e.setSelectionRange)e.setSelectionRange(t,t);else if("number"==typeof e.selectionStart)e.selectionStart=e.selectionEnd=t;else if("undefined"!=typeof e.createTextRange){e.focus();var n=e.createTextRange();n.collapse(!0),n.moveEnd(t),n.moveStart(t),n.select()}e.focus()},0)}.bind(this),this.print=function(e){this.cache.buffer.innerHTML+=e.replace(/\t/g,"    ")+"\n"}.bind(this),this.run=function(e){var t=this;e&&this.history.push(e);var n={input:e,original:e,command:null,argv:{},result:null},i=new Promise(function(e,t){return e(n)});return this.workers.pre.forEach(function(e){return e.forEach(function(e){i=i.then(function(t){return e.worker(t)})})}),i=i.then(function(e){return new Promise(function(n,i){var o;return e.command&&(o=t.workers.commands[e.command])?n(o.worker(e)).then(function(t){return e=t||e}):n(e)})}),this.workers.post.forEach(function(e){return e.forEach(function(e){i=i.then(function(t){return e.worker(t)})})}),i}.bind(this);var e=function(e,t,n,i,o){o||(o=0),void 0===i&&"function"==typeof n&&(i=n,n=null);var s={name:t,description:n,worker:i};"command"===e?this.workers.commands[t]=s:"keys"===e?(this.workers.keys[t]||(this.workers.keys[t]=[]),this.workers.keys[t].push(s)):(this.workers[e][o]||(this.workers[e][o]=[]),this.workers[e][o].push(s))}.bind(this);this.command=e.bind(this,"command"),this.preprocessor=e.bind(this,"pre"),this.postprocessor=e.bind(this,"post"),this.registerKey=e.bind(this,"keys")},function(e){e.command("clear","Clear screen",function(t){e.cache.buffer.innerHTML=""})}(window.cli),function(e){e.command("help","Display this list",function(t){e.print("List of available commands:"),Object.keys(e.workers.commands).sort().forEach(function(t){var n=e.workers.commands[t].description;e.print(["	",t,n?"- "+n:""].join(" "))})})}(window.cli),function(e){}(window.cli),function(e){function t(t){e.cache.commandInput.value=t,e.focus()}var n="",i=0;e.registerKey(38,"Up",function(o,s){s&&i!=e.history.length&&(i||(n=e.cache.commandInput.value),i++,i>e.history.length&&(i=e.history.length),t(e.history[e.history.length-i]))}),e.registerKey(40,"Down",function(o,s){if(s&&i){i--;var c="";0>=i?(i=0,c=n):c=e.history[e.history.length-i],t(c)}}),e.registerKey(13,"Enter",function(e,t){n="",i=0})}(window.cli),function(e){}(window.cli),function(e){function t(e){var t={_:[]};if(!e)return t;var n=e.match(/^(.*?)\s+\-\-\s+(.*)$/);if(n&&(e=n[1],n=n[2]),!e)return t._=[n],t;for(var i=e.split(""),o=[],s=!1,c=!1,r=[],a=0;a<=i.length;a++)if("\\"!==i[a])if(s)s=!1;else{if('"'===i[a]||"'"===i[a]){if(!c){o.push(r.join("").trim()),r=[],c={"char":i[a],position:a,text:[]};continue}if(c["char"]===i[a]){c.text=c.text.join(""),o.push(c),c=!1;continue}}c?c.text.push(i[a]):r.push(i[a])}else s=!0;for(o.push(r.join("").trim()),o=o.map(function(e){return"string"==typeof e?e.split(/\s+|=/):e}),o=[].concat.apply([],o),o=o.map(function(e){if(/^\-([^-]+)$/.test(e))return{flags:RegExp.$1.split("")};if(/^\-\-(.+)$/.test(e)){var t=RegExp.$1;return t=t.split("-").map(function(e){return e.charAt(0).toUpperCase()+e.slice(1)}).join(""),t=t.charAt(0).toLowerCase()+t.slice(1),{param:t}}return e}),o=o.map(function(e){return e.text||e}),o.push(n);o.length;){var l=o.shift();if(l)if("object"!==("undefined"==typeof l?"undefined":_typeof(l)))t._.push(l);else{var h=l.param;if(l.flags)for(h=l.flags.pop();l.flags.length;)t[l.flags.shift()]=!0;if("string"==typeof o[0]){t[h]=o.shift(),!isNaN(parseFloat(t[h]))&&isFinite(t[h])&&(t[h]=+t[h]);var u={"true":!0,"false":!1,"null":null,undefined:void 0};u.hasOwnProperty(t[h])&&(t[h]=u[t[h]])}else t[h]=!0}}return t}e.preprocessor("argv","Split command line to arguments",function(n){if(!n.input)return n;n.command=null;var i=Object.keys(e.workers.commands).sort(function(e,t){return t.length-e.length});return i.some(function(e){return 0===n.input.indexOf(e)&&(n.command=e,n.input=n.input.replace(e,"").trim()),n.command}),n.command&&(n.argv=t(n.input),n.input=""),n})}(window.cli),function(e){e.addHtml("templates/panel.html",'<div class="cli"><div onmouseup="cli.mouseUp()" class="cli-panel show"><div class="cli-history"><span class="cli-buffer"></span><span class="cli-loader hide_element"></span></div><div class="cli-line"><span class="cli-prompt"></span><input type="text" autofocus="autofocus" class="cli-command"/></div></div></div>',"body")}(window.cli),!function(){var e=".cli {\n  max-height: 64%; }\n  .cli-panel {\n    height: 0;\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    color: white;\n    font: 16px monospace;\n    background: rgba(0, 0, 0, 0.8);\n    line-height: 20px;\n    transition: height 0.64s linear; }\n  .cli-panel.show {\n    height: 64%; }\n  .cli-history {\n    overflow: auto;\n    white-space: pre-wrap;\n    position: absolute;\n    bottom: 20px; }\n    .cli-history .cli-prompt {\n      display: inline;\n      width: auto; }\n  .cli-line {\n    position: absolute;\n    bottom: 0;\n    height: 20px;\n    width: 100%;\n    display: table; }\n  .cli-prompt {\n    display: table-cell;\n    width: 1px; }\n  .cli-command {\n    background: none;\n    border: 0;\n    color: white;\n    outline: none;\n    font: 16px monospace;\n    padding-left: 12px;\n    width: 100%;\n    box-sizing: border-box;\n    display: table-cell; }\n  .cli .hide_element {\n    display: none; }\n",t=document.createElement("style");t.type="text/css",t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e)),(document.head||document.getElementsByTagName("head")[0]).appendChild(t)}();