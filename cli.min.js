!function(n){angular.modules=[],angular.module=function(){return arguments.length>1&&angular.modules.push(arguments[0]),n.apply(null,arguments)}}(angular.module),angular.module("cli",[]),angular.module("cli").run(function(){var n=angular.element("<ng-cli></ng-cli>");angular.element(document.body).append(n)}),angular.module("cli").service("$cli",["$q",function(n){this.prompt="> ",this.buffer="",this.history=[],this.workers={pre:[],commands:{},post:[]},this.print=function(n){this.buffer+=n+"\n"}.bind(this),this.run=function(e){this.history.push(e);var t={input:e,original:e,command:null,argv:{},result:null},o=this.workers.pre.reduce(function(e,o,r){return n.when(e).then(function(){return o.worker(t)})},t);return o=n.when(o).then(function(){var e;return t.command&&(e=this.workers.commands[t.command])?n.when(e.worker(t)).then(function(n){t=n||t}):n.when(t)}.bind(this)),o=n.when(o).then(function(){this.workers.post.reduce(function(e,o,r){return n.when(e).then(function(){return o.worker(t)})},n.when(t))}.bind(this)),o.then(function(){return t})}.bind(this);var e=function(n,e,t,o){void 0===o&&"function"==typeof t&&(o=t,t=null);var r={name:e,description:t,worker:o};"command"===n?this.workers.commands[e]=r:this.workers[n].push(r)};return this.command=e.bind(this,"command"),this.preprocessor=e.bind(this,"pre"),this.postprocessor=e.bind(this,"post"),this}]),angular.module("cli").directive("ngCli",["$timeout",function(n){return{templateUrl:"/panel.html",replace:!0,controller:["$scope","$cli",function(e,t){e.show=!1;var o=t.print;t.print=function(n){null!==n&&o(n),e.buffer=t.buffer.replace(/\t/g,"    ").replace(/  /g," Â ")},e.prompt=t.prompt;var r=document.querySelector(".cli .panel .line .command"),i=document.querySelector(".cli .panel .buffer");e.focus=function(){n(function(){var n=r.value.length;if(r.setSelectionRange)r.setSelectionRange(n,n);else if("number"==typeof r.selectionStart)r.selectionStart=r.selectionEnd=n;else if("undefined"!=typeof r.createTextRange){r.focus();var e=r.createTextRange();e.collapse(!0),e.moveEnd(n),e.moveStart(n),e.select()}r.focus()},0)},document.addEventListener("keydown",function(n){if(192===n.keyCode){if("INPUT"===n.target.nodeName&&n.target!==r)return;e.show=!e.show,e.show&&e.focus()}else 13===n.keyCode&&n.target===r&&(t.print(t.prompt+e.command),t.run(e.command),i.scrollTop=i.scrollHeight,e.command="");e.$apply()})}]}}]),angular.module("cli").run(["$cli",function(n){n.preprocessor("argv","Split command line to arguments",function(e){if(!e.input)return e;var t=e.input.match(/^\w+/);return-1!==Object.keys(n.workers.commands).indexOf(t&&t[0])&&(e.command=t[0],e.input=e.input.replace(t[0],"")),e})}]),angular.module("cli").run(["$cli",function(n){n.command("clear","Clear screen",function(e){n.buffer="",n.print(null)})}]),angular.module("cli").run(["$cli",function(n){n.command("help","Display this list",function(e){n.print("List of available commands:"),Object.keys(n.workers.commands).sort().forEach(function(e){var t=n.workers.commands[e].description;n.print(["	",e,t?"- "+t:""].join(" "))})})}]),angular.module("cli").run(["$cli",function($cli){function calc(string){return eval(string)}$cli.postprocessor("calc","Calculate input",function(n){return n.input?($cli.print(calc(n.input)),n):n})}]),angular.module("cli").run(["$templateCache",function(n){n.put("/panel.html",'<div class="cli">\n	<style>\n		.panel {\n			height: 64%;\n			position: absolute;\n			top: 0;\n			left: 0;\n			right: 0;\n			color: white;\n			font: 16px monospace;\n			background: rgba(0, 0, 0, 0.8);\n			line-height: 20px;\n		}\n		.buffer {\n			overflow: auto;\n			white-space: pre-line;\n			position: absolute;\n			bottom: 20px;\n		}\n		.line {\n			position: absolute;\n			bottom: 0;\n			height: 20px;\n			width: 100%;\n		}\n		.command {\n			background: none;\n			border: 0;\n			color: white;\n			outline: none;\n			font: 16px monospace;\n			padding-left: 20px;\n			width: 100%;\n			box-sizing: border-box;\n			margin-left: -20px;\n		}\n	</style>\n\n	<div class="panel" ng-show="show" ng-click="focus()">\n		<div class="buffer">{{buffer}}<span class="loader" ng-show="loading"></span></div>\n		<div class="line">\n			<span class="prompt">{{prompt}}</span>\n			<input type="text" class="command" ng-model="command" autofocus="autofocus"/>\n		</div>\n	</div>\n</div>')}]);